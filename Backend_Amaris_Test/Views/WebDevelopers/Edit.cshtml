@model Backend_Amaris_Test.ViewModel.WebDeveloperViewModel
@{
    ViewBag.Title = "WebDeveloperEdit";
}

<h2>Edit Web Developer</h2>

<form id="editWebDeveloper">
    <div class="form-group">
        @Html.LabelFor(x => x.FirstName)
        @Html.TextBoxFor(x => x.FirstName, new { @class = "form-control" })
        @Html.ValidationMessageFor(x => x.FirstName)
    </div>
    <div class="form-group">
        @Html.LabelFor(x => x.LastName)
        @Html.TextBoxFor(x => x.LastName, new { @class = "form-control", name = "lastname" })
        @Html.ValidationMessageFor(x => x.LastName)
    </div>
    <div class="form-group">
        @Html.LabelFor(x => x.Address)
        @Html.TextBoxFor(x => x.Address, new { @class = "form-control", name = "address" })
        @Html.ValidationMessageFor(x => x.Address)
    </div>
    <div class="form-group">
        @Html.LabelFor(x => x.Email)
        @Html.TextBoxFor(x => x.Email, new { @class = "form-control", name = "email" })
        @Html.ValidationMessageFor(x => x.Email)
    </div>
    <div class="form-group">
        @Html.LabelFor(x => x.ContactPhone)
        @Html.TextBoxFor(x => x.ContactPhone, new { @class = "form-control", name = "contactphone" })
        @Html.ValidationMessageFor(x => x.ContactPhone)
    </div>
    <div class="form-group">
        @Html.LabelFor(x => x.DayOfBirth)
        @Html.TextBoxFor(x => x.DayOfBirth, "{0:d MMM yyyy}", new { @class = "form-control", name = "dayofbirth" })
        @Html.ValidationMessageFor(x => x.DayOfBirth)
    </div>
    <div class="form-group">
        @Html.LabelFor(x => x.YearsOfExperience)
        @Html.TextBoxFor(x => x.YearsOfExperience, new { @class = "form-control", name = "yearsofexperience" })
        @Html.ValidationMessageFor(x => x.YearsOfExperience)
    </div>
    <div class="form-group">
        @Html.LabelFor(x => x.Comments)
        @Html.TextBoxFor(x => x.Comments, new { @class = "form-control", name = "comments" })
    </div> 
    <div class="form-group">
        @Html.LabelFor(x => x.WebTechnologies)
        <table>
            <tbody>
                @for (var i = 0; i < Model.WebTechnologies.Count; i++)
                {
                    if (i % 3 == 0)
                    {
                        @:<tr>
                    }
                    <td>
                        <div class="checkbox">
                            <label>
                                @Html.CheckBoxFor(x => x.WebTechnologies[i].IsSelected, new { data_rule_atLeatOneWebTechnology = "true", @class = "technology" })@Model.WebTechnologies[i].WebTechnology.Name
                                @*<input name="WebTechnologies[@i].IsSelected" data-rule-atLeatOneWebTechnology="true" type="checkbox" value="false" class="form-control" />*@
                            </label>
                        </div>
                    </td>
                    if (i % 3 == 2)
                    {
                        @:</tr>
                    }
                }
            </tbody>
        </table>
        <div class-="ioio"></div>
    </div>

    <button class="btn btn-primary">Save</button>
</form>

@section scripts
{
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        $(document).ready(function () {
            $.validator.addMethod("fnFedFidFod", function (value, element, param) {
                return $("input:checked").length > 2;
            }, "QQQQQQQQQQ");

            $.validator.addMethod("atLeatOneWebTechnology", function () {
                return $("input:checked").length > 0;
            }, "Please select at least one web technology");

            

            $("#editWebDeveloper").submit(function (e) {
                e.preventDefault();
                if ($("#editWebDeveloper").valid())
                {
                    $.ajax({
                        url: "/api/webdevelopers/1",
                        method: "put",
                        data: $("#editWebDeveloper").serialize()
                    })
                    .done(function () {
                        alert("OK");
                    })
                    .fail(function (er) {
                        alert(er.statusText);
                    });
                    return false;
                }

            });

            $("#editWebDeveloper").validate({
                rules: {
                    FirstName: {
                        required: true,
                        fnFedFidFod: true
                    }
                }
            });
        });
    </script>
}

